1. We enter the management page, Go to website settings.

![image](https://user-images.githubusercontent.com/39737245/179381624-70b8a26f-29c1-4208-b373-fff0250394df.png)

2. Next, I want to inject php code by modifying these settings.
From the config.php file we found that the modified configuration will be written that.

![image](https://user-images.githubusercontent.com/39737245/179381660-880f02c2-211c-40bc-87d7-f6f53994d864.png)

3. The format of configuration writing is as follows.

```
define('WEBNAME',	'taoCMS演示');
```

4. So according to the grammar rules of php, I made the following request.

![image](https://user-images.githubusercontent.com/39737245/179381735-40aef3c1-2b4d-4cbf-bf30-a16d64cef477.png)

```
payload: taoCMS演示');phpinfo();//
```
5. But I found that after executing the request, the code of the config.php file will have a syntax error.
```
define('WEBNAME',	'taoCMS演示'');phpinfo();//');
```
![image](https://user-images.githubusercontent.com/39737245/179381766-e03eab52-9f9a-4eef-aaef-cedd05f773b0.png)

6. when i view the taocms/include/Config.php, When the configuration is modified, the configuration is checked for security.

![image](https://user-images.githubusercontent.com/39737245/179381827-633154f9-d815-474f-8ddb-c2e4eae7690f.png)

7. Follow taocms/include/Base.php, in the safeword function.
The core point of discovery is that if the database type is Sqlite, a single (') will be replaced by a pair ('').

![image](https://user-images.githubusercontent.com/39737245/179381928-2e52e418-9ebb-4663-960b-fb0b6f189eb2.png)

8. After knowing all this, I constructed a payload, add a (\) to escape ('). Note that the database type is Sqlite.

```
payload: taoCMS演示\');phpinfo();//
```
![image](https://user-images.githubusercontent.com/39737245/179382078-ad2fa268-9f76-4c31-a223-a46eb659c45c.png)

9. After executing the request this time, I found that I successfully modified the configuration, and the code syntax check passed.

![image](https://user-images.githubusercontent.com/39737245/179382134-f29035ce-4cb9-4e98-acbf-4677830deeb6.png)

10. When I access Config.php everything works fine and the php code runs correctly.

![image](https://user-images.githubusercontent.com/39737245/179382173-55450e32-b36a-4e7b-a1c0-d28c7fde79de.png)
